<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ObScore – On‑Demand Music Arranging</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      background: #fafafa;
      color: #111;
    }
    header, section {
      max-width: 900px;
      margin: auto;
      padding: 24px;
    }
    header h1 {
      font-size: 2.5rem;
      margin-bottom: 0.2em;
    }
    h2 {
      margin-top: 0;
    }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    input, textarea, select, button {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    textarea {
      min-height: 120px;
    }
    button {
      background: #111;
      color: #fff;
      cursor: pointer;
      border: none;
      margin-top: 15px;
    }
    button.secondary {
      background: #eee;
      color: #111;
    }
    ul {
      padding-left: 20px;
    }
    .hidden {
      display: none;
    }
    footer {
      text-align: center;
      padding: 20px;
      font-size: 0.9rem;
      color: #555;
    }
  </style>
</head>
<body>

<header>
  <h1>ObScore</h1>
  <p>On‑demand arranging and orchestration for any ensemble</p>
</header>

<section id="auth" class="card">
  <h2>Sign up / Log in</h2>
  <input id="email" placeholder="Email address" />
  <select id="role">
    <option value="performer">Performer</option>
    <option value="arranger">Arranger</option>
  </select>
  <button onclick="login()">Continue</button>
</section>

<section id="performer" class="card hidden">
  <h2>Request an Arrangement</h2>
  <textarea id="requestText" placeholder="Describe the piece, instruments, deadline, etc."></textarea>
  <p style="font-size:0.9rem;color:#555;margin-top:8px;">You will be asked to attach files (PDF, images, Sibelius, etc.) in your email client after clicking send.</p>
  <button onclick="sendRequest()">Send Request</button>
</section>

<section id="arranger" class="card hidden">
  <h2>Arranger Profile</h2>
  <textarea id="bio" placeholder="Your bio"></textarea>
  <button onclick="saveBio()">Save Bio</button>

  <h3>Instruments you write for</h3>
  <input id="instrumentInput" placeholder="e.g. Oboe, Strings, Brass" />
  <button class="secondary" onclick="addInstrument()">Add Instrument</button>
  <ul id="instrumentList"></ul>

  <h3>Open Requests</h3>
  <ul id="requests"></ul>
</section>

<footer>
  © <span id="year"></span> ObScore
</footer>

<script>
  const EMAIL = "edwardtait06@outlook.com";
  let user = null;
  let users = JSON.parse(localStorage.getItem("obs_users") || "[]");
  let requests = JSON.parse(localStorage.getItem("obs_requests") || "[]");

  document.getElementById("year").textContent = new Date().getFullYear();

  function login() {
    const email = document.getElementById("email").value.trim();
    const role = document.getElementById("role").value;
    if (!email) return alert("Please enter an email");

    user = users.find(u => u.email === email);
    if (!user) {
      user = { email, role, bio: "", instruments: [] };
      users.push(user);
      localStorage.setItem("obs_users", JSON.stringify(users));
    }

    document.getElementById("auth").classList.add("hidden");
    if (user.role === "performer") {
      document.getElementById("performer").classList.remove("hidden");
    } else {
      document.getElementById("arranger").classList.remove("hidden");
      loadArranger();
    }
  }

  function sendRequest() {
    const text = document.getElementById("requestText").value;
    if (!text) return alert("Please describe the request");

    requests.push({ text, from: user.email });
    localStorage.setItem("obs_requests", JSON.stringify(requests));

    const body = `${text}\n\n---\nPlease attach your score files (PDF, images, notation files) to this email before sending.`;

    window.location.href = `mailto:${EMAIL}?subject=New ObScore Request&body=${encodeURIComponent(body)}`;
  });
    localStorage.setItem("obs_requests", JSON.stringify(requests));

    window.location.href = `mailto:${EMAIL}?subject=New ObScore Request&body=${encodeURIComponent(text)}`;
  }

  function loadArranger() {
    document.getElementById("bio").value = user.bio;
    renderInstruments();
    renderRequests();
  }

  function saveBio() {
    user.bio = document.getElementById("bio").value;
    saveUser();
  }

  function addInstrument() {
    const val = document.getElementById("instrumentInput").value.trim();
    if (!val) return;
    user.instruments.push(val);
    document.getElementById("instrumentInput").value = "";
    saveUser();
    renderInstruments();
  }

  function renderInstruments() {
    const ul = document.getElementById("instrumentList");
    ul.innerHTML = "";
    user.instruments.forEach(i => {
      const li = document.createElement("li");
      li.textContent = i;
      ul.appendChild(li);
    });
  }

  function renderRequests() {
    const ul = document.getElementById("requests");
    ul.innerHTML = "";
    requests.forEach(r => {
      const li = document.createElement("li");
      li.innerHTML = `<p>${r.text}</p><a href="mailto:${EMAIL}?subject=ObScore Response&body=${encodeURIComponent(r.text)}">Respond by email</a>`;
      ul.appendChild(li);
    });
  }

  function saveUser() {
    users = users.map(u => u.email === user.email ? user : u);
    localStorage.setItem("obs_users", JSON.stringify(users));
  }
</script>

</body>
</html>
